<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>SaveUs - Meal Log</title>
    <style>
        :root{
          --bg: #f5f7f9;
          --panel: #ffffff;
          --panel-2: #fbfcfd;
          --line: #e6eaee;
          --text: #111827;
          --muted: #6b7280;
          --primary: #19b07a;
          --primary-weak: #e7f7f1;
          --accent: #0ea5e9;
          --warning: #f59e0b;
          --radius-lg: 14px;
          --radius-md: 10px;
          --shadow-sm: 0 1px 2px rgba(16,24,40,0.06);
          --shadow-md: 0 8px 24px rgba(16,24,40,0.08);
          --sidebar-w: 220px;
        }

        *{ box-sizing: border-box; }
        body{
          margin:0;
          font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif;
          color: var(--text);
          background: var(--bg);
        }

        .app{
          display:flex;
          min-height: 100vh;
          width:100%;
        }

        /* Sidebar */
        .sidebar{
          width: var(--sidebar-w);
          background: var(--panel);
          border-right: 1px solid var(--line);
          padding: 18px 14px;
          position: sticky;
          top:0;
          height:100vh;
        }
        .brand{
          display:flex;
          align-items:center;
          gap:10px;
          font-weight: 800;
          letter-spacing: -0.3px;
          color:#0f766e;
          padding: 6px 8px 14px 8px;
          margin-bottom: 6px;
        }
        .brand-mark{
          width:28px;height:28px;border-radius:8px;
          background: var(--primary-weak);
          display:grid;place-items:center;
          color: var(--primary);
          font-weight:900;
          border:1px solid #d7efe6;
        }
        .nav{
          margin-top: 6px;
          display:flex;
          flex-direction:column;
          gap:4px;
        }
        .nav a{
          display:flex;
          align-items:center;
          gap:10px;
          padding: 10px 10px;
          border-radius: 10px;
          color:#111827;
          text-decoration:none;
          font-size:14px;
        }
        .nav a .dot{
          width:6px;height:6px;border-radius:999px;background:#cbd5e1;
        }
        .nav a.active{
          background: #f2f4f7;
          font-weight:700;
        }

        /* Content */
        .content{
          flex:1;
          padding: 18px 22px 40px 22px;
          max-width: 1200px;
          margin: 0 auto;
        }

        /* Top bar */
        .topbar{
          display:flex;
          align-items:center;
          justify-content:space-between;
          margin-bottom: 14px;
        }
        .topbar-title{
          font-size:18px;
          font-weight:800;
          color:#0f172a;
          display:flex;
          align-items:center;
          gap:8px;
        }
        .avatar{
          width:34px;height:34px;border-radius:999px;
          background:#e5e7eb;
          display:inline-block;
          border:1px solid var(--line);
        }

        /* Grid sections */
        .grid-2{
          display:grid;
          grid-template-columns: 1.4fr 1fr;
          gap: 14px;
          margin-bottom: 14px;
        }
        .card{
          background: var(--panel);
          border:1px solid var(--line);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
        }
        .card.pad{ padding: 16px; }

        .welcome{
          display:flex;
          align-items:center;
          justify-content:space-between;
          gap: 10px;
        }
        .welcome-left{
          display:flex; align-items:center; gap:12px;
        }
        .welcome h2{
          margin:0; font-size:16px; font-weight:800;
        }
        .persona{
          font-size:12px; color: var(--muted); margin-top:2px;
        }
        .tag{
          background: #e8f1ff;
          color: #1d4ed8;
          font-weight:700;
          padding:2px 8px;
          border-radius:999px;
          font-size:12px;
          border:1px solid #dbe7ff;
          display:inline-block;
          margin-left:6px;
        }

        .tip-title{
          font-size:12px; font-weight:800; color:#111827; margin:0 0 6px 0;
          text-transform: uppercase; letter-spacing:0.4px;
        }
        .tip-body{
          font-size:13px; color:#374151; line-height:1.5;
          margin:0;
        }

        /* Log your meal form */
        .log-section-title{
          font-size:14px; font-weight:800; margin: 0 0 4px 0;
        }
        .log-section-sub{
          font-size:12px; color: var(--muted); margin:0 0 10px 0;
        }

        .log-form{
          display:flex;
          align-items:center;
          gap:10px;
          flex-wrap:wrap;
        }

        .file-wrap{
          position:relative;
          display:flex;
          align-items:center;
          gap:8px;
          flex:1 1 320px;
          min-width: 260px;
          background: var(--panel-2);
          border: 1px dashed #cfe7dd;
          border-radius: 12px;
          padding: 10px 12px;
        }
        .file-wrap input[type="file"]{
          position:absolute;
          inset:0;
          opacity:0;
          cursor:pointer;
        }
        .file-icon{
          width:34px;height:34px;border-radius:10px;background: var(--primary-weak);
          color: var(--primary); display:grid; place-items:center; font-weight:900;
          border:1px solid #d7efe6; flex:0 0 auto;
        }
        .file-text{
          display:flex; flex-direction:column; gap:2px; min-width:0;
        }
        .file-text .label{
          font-size:13px; font-weight:700;
        }
        .file-text .name{
          font-size:12px; color: var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
          max-width: 380px;
        }

        .input-wrap{
          flex:1 1 240px;
          min-width: 220px;
          display:flex; gap:8px;
        }
        .input-wrap input[type="text"]{
          width:100%;
          border:1px solid var(--line);
          background:#fff;
          border-radius: 10px;
          padding: 10px 12px;
          font-size:13px;
          outline:none;
        }
        .input-wrap input[type="text"]:focus{
          border-color: #b7e4d2;
          box-shadow: 0 0 0 3px rgba(25,176,122,0.12);
        }

        .btn{
          border:none; cursor:pointer;
          padding: 10px 14px;
          font-size:13px; font-weight:800;
          border-radius: 10px;
          background: var(--primary);
          color:#fff;
          box-shadow: 0 6px 14px rgba(25,176,122,0.25);
          transition: transform .05s ease, filter .15s ease;
          white-space:nowrap;
        }
        .btn:active{ transform: translateY(1px); }
        .btn.secondary{
          background:#111827;
          box-shadow:none;
        }
        .btn.ghost{
          background:#fff;color:#111827;border:1px solid var(--line);box-shadow:none;
          font-weight:700;
        }

        .or{
          font-size:12px; color: var(--muted);
          padding: 0 4px;
        }

        /* Lower grid (meals + macro cards) */
        .grid-lower{
          display:grid;
          grid-template-columns: 1fr 220px 220px 220px;
          gap: 14px;
          align-items:start;
        }

        .meals h3{
          margin:0 0 2px 0; font-size:14px; font-weight:800;
        }
        .meals p{
          margin:0 0 10px 0; font-size:12px; color: var(--muted);
        }
        .meal-list{
          display:flex; flex-direction:column;
          background:#fff; border:1px solid var(--line);
          border-radius: 12px; overflow:hidden;
        }
        .meal-item{
          display:flex; align-items:center; justify-content:space-between;
          padding: 10px 12px; border-bottom:1px solid var(--line);
          font-size:13px;
        }
        .meal-item:last-child{ border-bottom:none; }
        .meal-meta{
          font-size:11px; color: var(--muted);
        }
        .meal-kcal{
          font-size:12px; font-weight:800; color:#0f766e;
        }

        .macro{
          padding: 12px 14px;
          display:flex; flex-direction:column; gap:4px;
        }
        .macro-title{
          font-size:12px; font-weight:800; color:#0f172a;
          display:flex; align-items:center; gap:6px;
        }
        .macro-value{
          font-size:18px; font-weight:900; color:#0f172a;
        }
        .macro-goal{
          font-size:11px; color: var(--muted);
        }
        .macro-badge{
          width:20px;height:20px;border-radius:6px;background:#eef2ff;color:#4338ca;
          display:grid;place-items:center;font-size:11px;font-weight:900;border:1px solid #e0e7ff;
        }

        /* Result area */
        .result-card{
          margin-top: 14px;
          padding: 14px 16px;
          border-left: 4px solid var(--primary);
          background: #ffffff;
        }
        .result-title{
          font-size:13px; font-weight:800; margin:0 0 6px 0;
        }
        .result-body{
          font-size:13px; color:#111827; margin:0;
          white-space:pre-wrap;
        }

        /* Responsive */
        @media (max-width: 1100px){
          .grid-lower{
            grid-template-columns: 1fr 1fr 1fr;
          }
          .grid-lower .meals{ grid-column: 1 / -1; }
        }
        @media (max-width: 820px){
          .sidebar{ position:fixed; left:-240px; }
          .content{ padding-left: 18px; }
          .grid-2{ grid-template-columns: 1fr; }
          .grid-lower{ grid-template-columns: 1fr; }
          .file-text .name{ max-width: 220px; }
        }
    </style>
</head>
<body>
<div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="brand">
            <div class="brand-mark">S</div>
            <div>SaveUs</div>
        </div>
        <nav class="nav">
            <a class="active" href="javascript:void(0)"><span class="dot"></span> Dashboard</a>
            <a href="javascript:void(0)"><span class="dot"></span> Calendar</a>
            <a href="javascript:void(0)"><span class="dot"></span> Challenges</a>
            <a href="javascript:void(0)"><span class="dot"></span> Community</a>
            <a href="javascript:void(0)"><span class="dot"></span> My Page</a>
        </nav>
    </aside>

    <!-- Main -->
    <main class="content">
        <div class="topbar">
            <div class="topbar-title">Dashboard</div>
            <div class="avatar" aria-hidden="true"></div>
        </div>

<!--        &lt;!&ndash; Top grid &ndash;&gt;-->
<!--        <section class="grid-2">-->
<!--            <div class="card pad">-->
<!--                <div class="welcome">-->
<!--                    <div class="welcome-left">-->
<!--                        <div class="avatar" aria-hidden="true"></div>-->
<!--                        <div>-->
<!--                            <h2>Welcome Back, Song!</h2>-->
<!--                            <div class="persona">-->
<!--                                Current Persona:-->
<!--                                <span class="tag">Carb-Lover</span>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->

<!--            <div class="card pad">-->
<!--                <div class="tip-title">Daily Tip</div>-->
<!--                <p class="tip-body">-->
<!--                    Don’t forget to incorporate a variety of colorful vegetables into your meals to boost your antioxidant intake and support overall well-being.-->
<!--                </p>-->
<!--            </div>-->
<!--        </section>-->

        <!-- Log section -->
        <section class="card pad">
            <h3 class="log-section-title">Log Your Meal</h3>
            <p class="log-section-sub">Quickly add your meals using AI photo analysis or manual input.</p>

            <form class="log-form" name="forData" method="post" th:object="${testDto}" enctype="multipart/form-data">
                <label class="file-wrap" for="fileInput">
                    <div class="file-icon">AI</div>
                    <div class="file-text">
                        <div class="label">AI Photo Upload</div>
                        <div class="name" id="fileName">선택된 파일이 없습니다.</div>
                    </div>
                    <input id="fileInput" type="file" th:field="*{file}" />
                </label>

                <span class="or">Or</span>

                <div class="input-wrap">
                    <input type="text" name="mealName" placeholder="Enter meal name manually..." />
                    <button class="btn" type="submit">Add Meal</button>
                </div>
            </form>
        </section>

<!--        &lt;!&ndash; Lower grid &ndash;&gt;-->
<!--        <section class="grid-lower" style="margin-top:14px;">-->
<!--            &lt;!&ndash; Today's meals &ndash;&gt;-->
<!--            <div class="card pad meals">-->
<!--                <h3>Today’s Meals</h3>-->
<!--                <p>Overview of your logged meal for the day.</p>-->

<!--                <div class="meal-list">-->
<!--                    <div class="meal-item">-->
<!--                        <div>-->
<!--                            Oatmeal with berries-->
<!--                            <div class="meal-meta">8:00 AM</div>-->
<!--                        </div>-->
<!--                        <div class="meal-kcal">350 kcal</div>-->
<!--                    </div>-->
<!--                    <div class="meal-item">-->
<!--                        <div>-->
<!--                            Chicken salad sandwich-->
<!--                            <div class="meal-meta">1:15 PM</div>-->
<!--                        </div>-->
<!--                        <div class="meal-kcal">480 kcal</div>-->
<!--                    </div>-->
<!--                    <div class="meal-item">-->
<!--                        <div>-->
<!--                            Apple slices with peanut butter-->
<!--                            <div class="meal-meta">4:30 PM</div>-->
<!--                        </div>-->
<!--                        <div class="meal-kcal">220 kcal</div>-->
<!--                    </div>-->
<!--                    <div class="meal-item">-->
<!--                        <div>-->
<!--                            Grilled salmon with asparagus-->
<!--                            <div class="meal-meta">7:10 PM</div>-->
<!--                        </div>-->
<!--                        <div class="meal-kcal">610 kcal</div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Macro cards &ndash;&gt;-->
<!--            <div class="card macro">-->
<!--                <div class="macro-title"><span class="macro-badge">P</span> Protein</div>-->
<!--                <div class="macro-value">75g</div>-->
<!--                <div class="macro-goal">Goal: 90g</div>-->
<!--            </div>-->

<!--            <div class="card macro">-->
<!--                <div class="macro-title"><span class="macro-badge">C</span> Carbohydrates</div>-->
<!--                <div class="macro-value">180g</div>-->
<!--                <div class="macro-goal">Goal: 200g</div>-->
<!--            </div>-->

<!--            <div class="card macro">-->
<!--                <div class="macro-title"><span class="macro-badge">F</span> Fats</div>-->
<!--                <div class="macro-value">55g</div>-->
<!--                <div class="macro-goal">Goal: 65g</div>-->
<!--            </div>-->
<!--        </section>-->

        <!-- Result -->
        <section class="card result-card" th:if="${result != 'GET'}">
            <div class="result-title">분석 결과</div>
            <p class="result-body"  th:text="${result.food_name}"></p>
            <p class="result-body" th:text="'칼로리: ' + ${result.calories_kcal}"></p>
            <p class="result-body" th:text="'탄수화물: ' + ${result.carbs_g}"></p>
            <p class="result-body" th:text="'단백질: ' + ${result.protein_g}"></p>
            <p class="result-body" th:text="'지방: ' + ${result.fat_g}"></p>
            <p class="result-body" th:text="'당류: ' + ${result.sugar_g}"></p>
            <p class="result-body" th:text="'식이섬유: ' + ${result.fiber_g}"></p>
            <p class="result-body" th:text="'나트륨: ' + ${result.sodium_mg}"></p>
            <p class="result-body" th:text="'칼슘: ' + ${result.calcium_mg}"></p>
        </section>
        <section class="card result-card" th:if="${result == null}">
            <div class="result-title">분석 결과</div>
            <p class="result-body">결과가 아직 없습니다.</p>
        </section>
    </main>
</div>

<script>
    (function(){
      const input = document.getElementById('fileInput');
      const nameEl = document.getElementById('fileName');

      if(input){
        input.addEventListener('change', function(){
          const file = input.files && input.files[0];
          nameEl.textContent = file ? file.name : '선택된 파일이 없습니다.';
        });
      }
    })();
</script>
</body>
</html>
