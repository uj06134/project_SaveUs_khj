<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">

<head>
    <title th:text="${profile.nickname + ' 님의 프로필'}"></title>
    <th:block layout:fragment="css">
        <link rel="stylesheet" th:href="@{/css/otherProfile.css}">
    </th:block>
</head>

<main layout:fragment="content">

    <div class="profile-wrapper">

        <!-- 🔹 타이틀 -->
        <h2 class="mypage-title" th:text="${profile.nickname + ' 님의 프로필'}"></h2>

        <!-- 🔹 프로필 카드 -->
        <div class="profile-card">

            <div class="profile-banner"></div>

            <div class="profile-inner">

                <img class="profile-img"
                     th:src="${profile.profileImageUrl != null ? profile.profileImageUrl : '/images/user-default.png'}">

                <div class="profile-info">

                    <h3 th:text="${profile.nickname}"></h3>

                    <div class="profile-tags">
                        <span class="goal-tag"
                              th:text="${profile.mainGoal == 0 ? '감량' :
                                   profile.mainGoal == 1 ? '증량' : '건강식'}"></span>

                        <span class="persona-tag"
                              th:if="${dietType != null}"
                              th:text="${dietType}"></span>
                    </div>

                    <p>이메일: <span th:text="${profile.email}"></span></p>
                    <p>가입일: <span th:text="${#temporals.format(profile.createdAt,'yyyy-MM-dd')}"></span></p>

                </div>
            </div>
        </div>


        <!-- 🔹 획득 뱃지 카드 -->
        <section class="badge-section">
            <h3>획득 뱃지</h3>

            <div class="badge-list">

                <div th:if="${#lists.isEmpty(badges)}" style="color:#aaa;">
                    아직 획득한 뱃지가 없습니다.
                </div>

                <div class="badge-card" th:each="b : ${badges}">
                    <img th:src="${b.imageUrl}">
                    <h4 th:text="${b.title}"></h4>
                    <p th:text="${b.description}"></p>
                </div>

            </div>
        </section>


        <!-- 🔹 챌린지 카드 -->
        <section class="challenge-section">
            <h3>진행 중인 챌린지</h3>

            <div class="challenge-list">

                <div th:if="${#lists.isEmpty(challenges)}" style="color:#aaa;">
                    진행 중인 챌린지가 없습니다.
                </div>

                <div class="challenge-card" th:each="c : ${challenges}">
                    <h4 th:text="${c.title}"></h4>
                    <p th:text="${c.description}"></p>

                    <div class="progress-bar">
                        <div class="fill"
                             th:style="'width:' + ${c.progressPercent != null ? c.progressPercent : 0} + '%'"></div>
                    </div>

                    <p class="percent"
                       th:text="${(c.progressPercent != null ? c.progressPercent : 0) + '% 진행중!'}"></p>

                </div>

            </div>
        </section>

    </div>

</main>
</html>
